(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{3868:(e,t,a)=>{Promise.resolve().then(a.bind(a,3686))},3686:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>_});var s=a(5155),d=a(2115),i=a(2883),r=a(8173),l=a.n(r),n=a(5240),o=a(7604),c=a(6220),m=a(1879),u=a(3463),p=a(2607),x=a(9522),h=a(113);let g={emailCount:0,websiteCount:0,domainCount:0,toolCount:0,projectCount:0},v=[{name:"Email Templates",icon:n.A,href:"/dashboard/email",color:"bg-blue-500",stat:"emailCount"},{name:"Websites",icon:o.A,href:"/dashboard/website",color:"bg-green-500",stat:"websiteCount"},{name:"Domains",icon:c.A,href:"/dashboard/domains",color:"bg-purple-500",stat:"domainCount"},{name:"Tools",icon:m.A,href:"/dashboard/tools",color:"bg-orange-500",stat:"toolCount"}];function _(){let{supabase:e,user:t}=(0,i._)(),[a,r]=(0,d.useState)(g),[_,j]=(0,d.useState)([]),[y,N]=(0,d.useState)(!0),[f,b]=(0,d.useState)(null),[w,C]=(0,d.useState)(!1);return((0,d.useEffect)(()=>{C(!0)},[]),(0,d.useEffect)(()=>{(async function(){if(t)try{var a,s,d,i,l;N(!0),b(null);let[n,o,c,m,u]=await Promise.all([e.from("emails").select("id",{count:"exact"}),e.from("websites").select("id",{count:"exact"}),e.from("my_domains").select("id",{count:"exact"}),e.from("tools").select("id",{count:"exact"}),e.from("projects").select("id",{count:"exact"})]);r({emailCount:n.count||0,websiteCount:o.count||0,domainCount:c.count||0,toolCount:m.count||0,projectCount:u.count||0});let[p,g,v,_,y]=await Promise.all([e.from("emails").select("id, email, description, created_at, updated_at").eq("user_id",t.id).order("updated_at",{ascending:!1}).limit(3),e.from("websites").select("id, website, description, url, created_at, updated_at").eq("user_id",t.id).order("updated_at",{ascending:!1}).limit(3),e.from("my_domains").select("id, domain_name, registrar, expire_date, created_at, updated_at").eq("user_id",t.id).order("updated_at",{ascending:!1}).limit(3),e.from("tools").select("id, name, description, url, created_at, updated_at").eq("user_id",t.id).order("updated_at",{ascending:!1}).limit(3),e.from("projects").select("id, name, description, repository_url, live_url, created_at, updated_at").eq("user_id",t.id).order("updated_at",{ascending:!1}).limit(3)]),f=[...(null===(a=p.data)||void 0===a?void 0:a.map(e=>({type:"email",id:e.id,title:e.email,description:e.description,created_at:e.created_at,updated_at:e.updated_at})))||[],...(null===(s=g.data)||void 0===s?void 0:s.map(e=>({type:"website",id:e.id,title:e.website,description:e.description,url:e.url,created_at:e.created_at,updated_at:e.updated_at})))||[],...(null===(d=v.data)||void 0===d?void 0:d.map(e=>({type:"domain",id:e.id,title:e.domain_name,description:"Expires: ".concat((0,x.GP)((0,h.H)(e.expire_date),"MMM dd, yyyy")),registrar:e.registrar,created_at:e.created_at,updated_at:e.updated_at})))||[],...(null===(i=_.data)||void 0===i?void 0:i.map(e=>({type:"tool",id:e.id,title:e.name,description:e.description,url:e.url,created_at:e.created_at,updated_at:e.updated_at})))||[],...(null===(l=y.data)||void 0===l?void 0:l.map(e=>({type:"project",id:e.id,title:e.name,description:e.description,repository_url:e.repository_url,live_url:e.live_url,created_at:e.created_at,updated_at:e.updated_at})))||[]].sort((e,t)=>new Date(t.updated_at).getTime()-new Date(e.updated_at).getTime());j(f.slice(0,3))}catch(e){console.error("Error fetching dashboard data:",e),b(e.message)}finally{N(!1)}})()},[e,t]),w)?y?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"bg-white rounded-lg shadow p-6 animate-pulse",children:(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"})}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4",children:[1,2,3,4].map(e=>(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 animate-pulse",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"})]},e))})]}):f?(0,s.jsx)("div",{className:"rounded-md bg-red-50 p-4 my-4",children:(0,s.jsx)("div",{className:"flex",children:(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,s.jsx)("div",{className:"mt-2 text-sm text-red-700",children:(0,s.jsx)("p",{children:f})})]})})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"bg-white overflow-hidden rounded-lg shadow",children:(0,s.jsx)("div",{className:"px-4 py-5 sm:p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(u.A,{className:"h-8 w-8 text-gray-400"}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Welcome back!"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:null==t?void 0:t.email})]})]})})}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4",children:v.map(e=>(0,s.jsx)(l(),{href:e.href,className:"relative group bg-white overflow-hidden rounded-lg shadow hover:shadow-lg transition-shadow duration-200",children:(0,s.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(e.icon,{className:"h-6 w-6 text-gray-400 group-hover:text-gray-500"}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500 group-hover:text-gray-700",children:e.name}),(0,s.jsx)("p",{className:"mt-1 text-3xl font-semibold text-gray-900",children:a[e.stat]})]})]}),(0,s.jsx)(p.A,{className:"h-12 w-12 text-gray-200"})]}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 h-1 w-full ".concat(e.color," opacity-75")})]})},e.name))}),(0,s.jsx)("div",{className:"bg-white overflow-hidden rounded-lg shadow",children:(0,s.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Recent Activity"}),(0,s.jsx)("div",{className:"mt-4",children:0===_.length?(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"No recent activity"}):(0,s.jsx)("div",{className:"mt-6 flow-root",children:(0,s.jsx)("ul",{role:"list",className:"-my-5 divide-y divide-gray-200",children:_.map(e=>(0,s.jsx)("li",{className:"py-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"flex-shrink-0",children:["email"===e.type&&(0,s.jsx)(n.A,{className:"h-5 w-5 text-blue-500"}),"website"===e.type&&(0,s.jsx)(o.A,{className:"h-5 w-5 text-green-500"}),"domain"===e.type&&(0,s.jsx)(c.A,{className:"h-5 w-5 text-purple-500"}),"tool"===e.type&&(0,s.jsx)(m.A,{className:"h-5 w-5 text-orange-500"})]}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsx)("p",{className:"truncate text-sm font-medium text-gray-900",children:e.title}),e.description&&(0,s.jsx)("p",{className:"truncate text-sm text-gray-500",children:e.description}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Updated ",(0,x.GP)((0,h.H)(e.updated_at),"PPp")]})]}),e.url&&(0,s.jsx)("div",{children:(0,s.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:"View"})})]})},"".concat(e.type,"-").concat(e.id)))})})})]})})]}):null}},2883:(e,t,a)=>{"use strict";a.d(t,{A:()=>n,_:()=>o});var s=a(5155),d=a(2115),i=a(9806),r=a(6046);let l=(0,d.createContext)(void 0);function n(e){let{children:t}=e,[a,n]=(0,d.useState)(null),[o]=(0,d.useState)(()=>(0,i.createClientComponentClient)()),c=(0,r.useRouter)();return(0,d.useEffect)(()=>{let{data:{subscription:e}}=o.auth.onAuthStateChange((e,t)=>{var a;n(null!==(a=null==t?void 0:t.user)&&void 0!==a?a:null),"SIGNED_OUT"===e?c.replace("/login"):"SIGNED_IN"===e&&c.replace("/dashboard")});return o.auth.getSession().then(e=>{var t;let{data:{session:a}}=e;n(null!==(t=null==a?void 0:a.user)&&void 0!==t?t:null)}),()=>{e.unsubscribe()}},[o,c]),(0,s.jsx)(l.Provider,{value:{supabase:o,user:a},children:t})}let o=()=>{let e=(0,d.useContext)(l);if(void 0===e)throw Error("useSupabase must be used inside SupabaseProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[833,397,919,441,517,358],()=>t(3868)),_N_E=e.O()}]);