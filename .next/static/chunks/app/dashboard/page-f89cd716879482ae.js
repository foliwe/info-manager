(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[105],{3868:(e,t,a)=>{Promise.resolve().then(a.bind(a,3686))},3686:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var s=a(5155),d=a(2115),r=a(2883),i=a(8173),l=a.n(i),c=a(5240),n=a(7604),o=a(6928),m=a(1879),u=a(3463),p=a(2607),x=a(9522),h=a(113);let g={emailCount:0,websiteCount:0,projectCount:0,toolCount:0},v=[{name:"Email Templates",icon:c.A,href:"/dashboard/email",color:"bg-blue-500",stat:"emailCount"},{name:"Websites",icon:n.A,href:"/dashboard/website",color:"bg-green-500",stat:"websiteCount"},{name:"Projects",icon:o.A,href:"/dashboard/projects",color:"bg-purple-500",stat:"projectCount"},{name:"Tools",icon:m.A,href:"/dashboard/tools",color:"bg-orange-500",stat:"toolCount"}];function j(){let{supabase:e,user:t}=(0,r._)(),[a,i]=(0,d.useState)(g),[j,_]=(0,d.useState)([]),[N,f]=(0,d.useState)(!0),[b,y]=(0,d.useState)(null),[w,C]=(0,d.useState)(!1);return((0,d.useEffect)(()=>{C(!0)},[]),(0,d.useEffect)(()=>{(async function(){if(t)try{var a,s,d,r;f(!0),y(null);let[l,c,n,o]=await Promise.all([e.from("emails").select("id",{count:"exact"}),e.from("websites").select("id",{count:"exact"}),e.from("projects").select("id",{count:"exact"}),e.from("tools").select("id",{count:"exact"})]);i({emailCount:l.count||0,websiteCount:c.count||0,projectCount:n.count||0,toolCount:o.count||0});let[m,u,p,x]=await Promise.all([e.from("emails").select("id, subject, body, created_at, updated_at").eq("user_id",t.id).order("updated_at",{ascending:!1}).limit(10),e.from("websites").select("id, name, description, url, created_at, updated_at").eq("user_id",t.id).order("updated_at",{ascending:!1}).limit(10),e.from("projects").select("id, name, description, live_url, created_at, updated_at").eq("user_id",t.id).order("updated_at",{ascending:!1}).limit(10),e.from("tools").select("id, name, description, url, created_at, updated_at").eq("user_id",t.id).order("updated_at",{ascending:!1}).limit(10)]),h=[...(null===(a=m.data)||void 0===a?void 0:a.map(e=>({id:e.id,type:"email",action:e.created_at===e.updated_at?"created":"updated",name:e.subject,description:e.body,created_at:e.created_at,updated_at:e.updated_at})))||[],...(null===(s=u.data)||void 0===s?void 0:s.map(e=>({id:e.id,type:"website",action:e.created_at===e.updated_at?"created":"updated",name:e.name,description:e.description,url:e.url,created_at:e.created_at,updated_at:e.updated_at})))||[],...(null===(d=p.data)||void 0===d?void 0:d.map(e=>({id:e.id,type:"project",action:e.created_at===e.updated_at?"created":"updated",name:e.name,description:e.description,url:e.live_url,created_at:e.created_at,updated_at:e.updated_at})))||[],...(null===(r=x.data)||void 0===r?void 0:r.map(e=>({id:e.id,type:"tool",action:e.created_at===e.updated_at?"created":"updated",name:e.name,description:e.description,url:e.url,created_at:e.created_at,updated_at:e.updated_at})))||[]].sort((e,t)=>new Date(t.updated_at||t.created_at).getTime()-new Date(e.updated_at||e.created_at).getTime()).slice(0,10);_(h)}catch(e){console.error("Error fetching dashboard data:",e),y(e.message)}finally{f(!1)}})()},[e,t]),w)?N?(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"bg-white rounded-lg shadow p-6 animate-pulse",children:(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"})}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4",children:[1,2,3,4].map(e=>(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow p-6 animate-pulse",children:[(0,s.jsx)("div",{className:"h-4 bg-gray-200 rounded w-1/2 mb-4"}),(0,s.jsx)("div",{className:"h-8 bg-gray-200 rounded w-1/4"})]},e))})]}):b?(0,s.jsx)("div",{className:"rounded-md bg-red-50 p-4 my-4",children:(0,s.jsx)("div",{className:"flex",children:(0,s.jsxs)("div",{className:"ml-3",children:[(0,s.jsx)("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),(0,s.jsx)("div",{className:"mt-2 text-sm text-red-700",children:(0,s.jsx)("p",{children:b})})]})})}):(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsx)("div",{className:"bg-white overflow-hidden rounded-lg shadow",children:(0,s.jsx)("div",{className:"px-4 py-5 sm:p-6",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(u.A,{className:"h-8 w-8 text-gray-400"}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Welcome back!"}),(0,s.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:null==t?void 0:t.email})]})]})})}),(0,s.jsx)("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-4",children:v.map(e=>(0,s.jsx)(l(),{href:e.href,className:"relative group bg-white overflow-hidden rounded-lg shadow hover:shadow-lg transition-shadow duration-200",children:(0,s.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(e.icon,{className:"h-6 w-6 text-gray-400 group-hover:text-gray-500"}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500 group-hover:text-gray-700",children:e.name}),(0,s.jsx)("p",{className:"mt-1 text-3xl font-semibold text-gray-900",children:a[e.stat]})]})]}),(0,s.jsx)(p.A,{className:"h-12 w-12 text-gray-200"})]}),(0,s.jsx)("div",{className:"absolute bottom-0 left-0 h-1 w-full ".concat(e.color," opacity-75")})]})},e.name))}),(0,s.jsx)("div",{className:"bg-white overflow-hidden rounded-lg shadow",children:(0,s.jsxs)("div",{className:"px-4 py-5 sm:p-6",children:[(0,s.jsx)("h3",{className:"text-lg font-medium leading-6 text-gray-900",children:"Recent Activity"}),(0,s.jsx)("div",{className:"mt-4",children:0===j.length?(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"No recent activity"}):(0,s.jsx)("div",{className:"mt-6 flow-root",children:(0,s.jsx)("ul",{role:"list",className:"-my-5 divide-y divide-gray-200",children:j.map(e=>(0,s.jsx)("li",{className:"py-4",children:(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsxs)("div",{className:"flex-shrink-0",children:["email"===e.type&&(0,s.jsx)(c.A,{className:"h-5 w-5 text-blue-500"}),"website"===e.type&&(0,s.jsx)(n.A,{className:"h-5 w-5 text-green-500"}),"project"===e.type&&(0,s.jsx)(o.A,{className:"h-5 w-5 text-purple-500"}),"tool"===e.type&&(0,s.jsx)(m.A,{className:"h-5 w-5 text-orange-500"})]}),(0,s.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,s.jsx)("p",{className:"truncate text-sm font-medium text-gray-900",children:e.name}),e.description&&(0,s.jsx)("p",{className:"truncate text-sm text-gray-500",children:e.description}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["created"===e.action?"Added":"Updated"," ",(0,x.GP)((0,h.H)(e.updated_at||e.created_at),"PPp")]})]}),e.url&&(0,s.jsx)("div",{children:(0,s.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center rounded-md bg-white px-2.5 py-1.5 text-sm font-semibold text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 hover:bg-gray-50",children:"View"})})]})},"".concat(e.type,"-").concat(e.id)))})})})]})})]}):null}},2883:(e,t,a)=>{"use strict";a.d(t,{A:()=>c,_:()=>n});var s=a(5155),d=a(2115),r=a(9806),i=a(6046);let l=(0,d.createContext)(void 0);function c(e){let{children:t}=e,[a,c]=(0,d.useState)(null),[n]=(0,d.useState)(()=>(0,r.createClientComponentClient)()),o=(0,i.useRouter)();return(0,d.useEffect)(()=>{let{data:{subscription:e}}=n.auth.onAuthStateChange((e,t)=>{var a;c(null!==(a=null==t?void 0:t.user)&&void 0!==a?a:null),"SIGNED_OUT"===e?o.replace("/login"):"SIGNED_IN"===e&&o.replace("/dashboard")});return n.auth.getSession().then(e=>{var t;let{data:{session:a}}=e;c(null!==(t=null==a?void 0:a.user)&&void 0!==t?t:null)}),()=>{e.unsubscribe()}},[n,o]),(0,s.jsx)(l.Provider,{value:{supabase:n,user:a},children:t})}let n=()=>{let e=(0,d.useContext)(l);if(void 0===e)throw Error("useSupabase must be used inside SupabaseProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[833,212,302,441,517,358],()=>t(3868)),_N_E=e.O()}]);